{"datasets":[{"name":"8d75d358","displayName":"binary_options","query":"SELECT option\nFROM (VALUES ('Yes'), ('No')) AS options(option)"},{"name":"3e6fd95c","displayName":"statement_level_allocation","query":"WITH warehouse_snapshot AS (\n  SELECT warehouse_id,\n  warehouse_name,\n  workspace_id,\n  account_id\n  change_time,\n  delete_time,\n  CASE WHEN delete_time IS NOT NULL THEN 'Deleted' ELSE 'Active' END AS is_deleted\n  FROM system.compute.warehouses w\n  WHERE\n    -- workspace filter\n    (array_contains(:workspace_id,w.workspace_id) OR array_contains(:workspace_id,'all'))\n  -- warehouse filter\n    AND (array_contains(:warehouse_name, CONCAT(w.warehouse_name, ' (id:', w.warehouse_id, ')')) OR array_contains(:warehouse_name,'all'))\n  QUALIFY ROW_NUMBER() OVER (PARTITION BY workspace_id, warehouse_id ORDER BY change_time DESC) == 1 -- Get more recent snapshot\n),\n\nroot_table AS (\n  SELECT * \n    FROM main.default.dbsql_cost_per_query AS qq\n  WHERE\n  query_attributed_dollars_estimation IS NOT NULL\n  -- workspace filter\n    AND (array_contains(:workspace_id,qq.workspace_id) OR array_contains(:workspace_id,'all'))\n  -- warehouse filter\n    AND (array_contains(:warehouse_id,qq.warehouse_id) OR array_contains(:warehouse_id,'all'))\n  -- time filter (based on query start time)\n    AND query_start_hour BETWEEN CAST(:time_range.min AS TIMESTAMP) AND CAST(:time_range.max AS TIMESTAMP) -- for good pruning\n  -- statement_id filter - optional\n    AND (array_contains(:statement_id,qq.statement_id) OR array_contains(:statement_id,'all')) -- optional statement id filter\n),\n\ntop_n_filter AS (\n  SELECT \n    IDENTIFIER(CASE \n        WHEN :top_n_dimension = 'Executed By' THEN 'executed_by'\n        WHEN :top_n_dimension = 'Source Type' THEN 'query_source_type'\n        WHEN :top_n_dimension = 'Object Id' THEN 'query_source_id'\n        WHEN :top_n_dimension = 'Statement Id' THEN 'statement_id'\n        ELSE 'statement_id'\n    END) AS rank_key,\n  ROW_NUMBER() OVER (ORDER BY SUM(query_attributed_dollars_estimation) DESC) AS cost_rank\n  FROM root_table AS qq\n  GROUP BY\n    IDENTIFIER(CASE \n        WHEN :top_n_dimension = 'Executed By' THEN 'executed_by'\n        WHEN :top_n_dimension = 'Source Type' THEN 'query_source_type'\n        WHEN :top_n_dimension = 'Object Id' THEN 'query_source_id'\n        WHEN :top_n_dimension = 'Statement Id' THEN 'statement_id'\n        ELSE 'statement_id'\n    END)\n),\n\nmv_model AS (\n\n  SELECT qq.*,\n  CONCAT(w.warehouse_name, ' (id:', w.warehouse_id, ')') AS warehouse_name ,\n  w.is_deleted AS is_warehouse_deleted,\n  query_attributed_dollars_estimation * (1 - CAST(:dbsql_discount AS FLOAT)) AS query_attributed_dollars_with_discount,\n  --ROW_NUMBER() OVER (PARTITION BY CASE WHEN :ORDER BY QueryAllocationDollars DESC) AS CostRank\n  tn.cost_rank\n  FROM root_table AS qq\n  INNER JOIN warehouse_snapshot w ON qq.workspace_id = w.workspace_id AND qq.warehouse_id = w.warehouse_id\n  LEFT JOIN top_n_filter AS tn ON IDENTIFIER(CASE \n        WHEN :top_n_dimension = 'Executed By' THEN 'qq.executed_by'\n        WHEN :top_n_dimension = 'Source Type' THEN 'qq.query_source_type'\n        WHEN :top_n_dimension = 'Object Id' THEN 'qq.query_source_id'\n        WHEN :top_n_dimension = 'Statement Id' THEN 'qq.statement_id'\n        ELSE 'statement_id'\n    END) = tn.rank_key\n)\n\nSELECT\n  mv.*,\n  CASE WHEN :group_key = 'Warehouse Id' THEN mv.warehouse_id\n      WHEN :group_key = 'Warehouse Name' THEN mv.warehouse_name\n      WHEN :group_key = 'User' THEN mv.executed_by\n      WHEN :group_key = 'Source Type' THEN mv.query_source_type\n      WHEN :group_key = 'Obect Id' THEN mv.query_source_id\n      WHEN :group_key = 'Client' THEN mv.client_application\n      WHEN :group_key = 'Workspace Id' THEN mv.workspace_id\n      END AS group_key,\n      CASE WHEN :date_agg_level = 'HOUR' THEN \n                date_trunc(:date_agg_level, mv.start_time)::timestamp::string\n            ELSE date_trunc(:date_agg_level, mv.start_time)::date::string\n      END AS time_agg_key,\n  -- Data formatting for visuals\n    MAX(query_attributed_dollars_with_discount) OVER() AS fully_loaded_max_usage,\n    MIN(query_attributed_dollars_with_discount) OVER() AS fully_loaded_min_usage,\n    COALESCE(CONCAT(\n      '<div style=\"position: relative; height: 20px; border-radius: 4px; overflow: hidden;\">',\n      '<div style=\"position: absolute; width: ', \n      ROUND((query_attributed_dollars_with_discount - fully_loaded_min_usage) / NULLIF(fully_loaded_max_usage - fully_loaded_min_usage, 0) * 100, 2), \n      '%; height: 100%; background: #077A9D; border-radius: 4px;\"></div>',\n      '<span style=\"position: absolute; width: 100%; text-align: center; line-height: 20px; font-weight: bold; color: #00A972;\">$',\n      FORMAT_NUMBER(query_attributed_dollars_with_discount, 2), \n      '</span></div>'\n    ), '--') AS allocated_dollars_usage_bar_html,\n-- Data formatting for visuals\n    MAX(query_attributed_dbus_estimation) OVER() AS fully_loaded_max_usage_dbus,\n    MIN(query_attributed_dbus_estimation) OVER() AS fully_loaded_min_usage_dbus,\n    COALESCE(CONCAT(\n      '<div style=\"position: relative; height: 20px; border-radius: 4px; overflow: hidden;\">',\n      '<div style=\"position: absolute; width: ', \n      ROUND((query_attributed_dbus_estimation - fully_loaded_min_usage_dbus) / NULLIF(fully_loaded_max_usage_dbus - fully_loaded_min_usage_dbus, 0) * 100, 2), \n      '%; height: 100%; background: #077A9D; border-radius: 4px;\"></div>',\n      '<span style=\"position: absolute; width: 100%; text-align: center; line-height: 20px; font-weight: bold; color: #00A972;\">$',\n      FORMAT_NUMBER(query_attributed_dbus_estimation, 2), \n      '</span></div>'\n    ), '--') AS allocated_dbus_usage_bar_html\nFROM mv_model AS mv\nWHERE\n(lower(:top_n)::string = 'all' OR cost_rank <= :top_n::int) -- There can be ties, so we will also do a limit\nORDER BY cost_rank, query_attributed_dollars_with_discount DESC\n\n\n","parameters":[{"displayName":"statement_id","keyword":"statement_id","dataType":"STRING","complexType":"MULTI","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"all"}]}}},{"displayName":"workspace_id","keyword":"workspace_id","dataType":"STRING","complexType":"MULTI","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"all"}]}}},{"displayName":"warehouse_id","keyword":"warehouse_id","dataType":"STRING","complexType":"MULTI","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"all"}]}}},{"displayName":"warehouse_name","keyword":"warehouse_name","dataType":"STRING","complexType":"MULTI","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"all"}]}}},{"displayName":"top_n_dimension","keyword":"top_n_dimension","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"Executed By"}]}}},{"displayName":"dbsql_discount","keyword":"dbsql_discount","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"0.0"}]}}},{"displayName":"group_key","keyword":"group_key","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"User"}]}}},{"displayName":"date_agg_level","keyword":"date_agg_level","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"DAY"}]}}},{"displayName":"top_n","keyword":"top_n","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"all"}]}}},{"displayName":"time_range","keyword":"time_range","dataType":"DATETIME","complexType":"RANGE","defaultSelection":{"range":{"dataType":"DATETIME","min":{"value":"now-7d/d"},"max":{"value":"now-1d/d"}}}}]},{"name":"b6c55fed","displayName":"workspace_with_all","query":"  WITH billing AS (\n      SELECT workspace_id, usage_metadata.warehouse_id AS warehouse_id\n    FROM system.billing.usage u\n    WHERE usage_start_time BETWEEN date_trunc('hour', :start_time) AND :end_time\n    AND usage_metadata.warehouse_id IS NOT NULL\n    GROUP BY 1,2\n  )\n  -- Get warehouse names (most recent change record) for warehouses with usage in selected period\n  SELECT w.workspace_id, w.warehouse_id,   CONCAT(w.warehouse_name, ' (id:', w.warehouse_id, ')') AS warehouse_name\n  FROM billing AS b\n  JOIN system.compute.warehouses w ON b.workspace_id = w.workspace_id AND w.warehouse_id = b.warehouse_id\n  QUALIFY ROW_NUMBER() OVER(PARTITION BY w.workspace_id, w.warehouse_id ORDER BY w.change_time DESC) == 1","parameters":[{"displayName":"start_time","keyword":"start_time","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"2024-12-04T15:45:12.000"}]}}},{"displayName":"end_time","keyword":"end_time","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now-1m/m"}]}}}]},{"name":"773aca07","displayName":"select_time_agg","query":"SELECT explode(array('YEAR', 'QUARTER', 'MONTH', 'WEEK', 'DAY', 'HOUR')) AS time_agg_toggle"},{"name":"706e050f","displayName":"select_dynamic_group_key_toggle","query":"SELECT explode(array('User', 'Warehouse Id', 'Warehouse Name', 'Object Id', 'Source Type', 'Workspace Id')) AS group_key\n"},{"name":"9dda0ef1","displayName":"select_top_n_dim","query":"SELECT explode(array('Executed By', 'Source Type', 'Object Id', 'Statement Id')) AS object_top_n_toggle"}],"pages":[{"name":"3972306b","displayName":"Query Cost Overview","layout":[{"widget":{"name":"1274573c","queries":[{"name":"parameter_dashboards/01efde5dd4c51fc89e1caf2a86c344d7/datasets/01efde5dd4c615cd98f5bc2e8fab18b5_time_range","query":{"datasetName":"3e6fd95c","parameters":[{"name":"time_range","keyword":"time_range"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-range-picker","encodings":{"fields":[{"parameterName":"time_range","queryName":"parameter_dashboards/01efde5dd4c51fc89e1caf2a86c344d7/datasets/01efde5dd4c615cd98f5bc2e8fab18b5_time_range"}]},"frame":{"showTitle":true,"title":"Time Range"}}},"position":{"x":0,"y":6,"width":2,"height":2}},{"widget":{"name":"029aeeb6","queries":[{"name":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef015641455b4942decd4151ed3_workspace_id","query":{"datasetName":"b6c55fed","fields":[{"name":"workspace_id","expression":"`workspace_id`"},{"name":"workspace_id_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}},{"name":"parameter_dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_workspace_id","query":{"datasetName":"3e6fd95c","parameters":[{"name":"workspace_id","keyword":"workspace_id"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-multi-select","encodings":{"fields":[{"parameterName":"workspace_id","queryName":"parameter_dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_workspace_id"},{"fieldName":"workspace_id","displayName":"workspace_id","queryName":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef015641455b4942decd4151ed3_workspace_id"}]},"frame":{"showTitle":true,"title":"Workspace Id"}}},"position":{"x":2,"y":6,"width":1,"height":2}},{"widget":{"name":"8ad3de2b","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"sum(query_attributed_dollars_with_discount)","expression":"SUM(`query_attributed_dollars_with_discount`)"},{"name":"sum(query_attributed_dbus_estimation)","expression":"SUM(`query_attributed_dbus_estimation`)"},{"name":"countdistinct(statement_id)","expression":"COUNT(DISTINCT `statement_id`)"},{"name":"executed_by","expression":"`executed_by`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(query_attributed_dollars_with_discount)","scale":{"type":"quantitative","reverse":false},"format":{"type":"number-currency","currencyCode":"USD","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Attributed Usage ($)"},"y":{"fieldName":"executed_by","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"axis":{"title":"User"},"displayName":"Group Key"},"color":{"fieldName":"sum(query_attributed_dollars_with_discount)","scale":{"type":"quantitative","colorRamp":{"mode":"scheme","scheme":"greenblue"}},"legend":{"hide":true},"displayName":"Attributed Usage ($)"},"label":{"show":true},"extra":[{"fieldName":"sum(query_attributed_dbus_estimation)","format":{"type":"number-plain","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Attributed Usage (DBUs)"},{"fieldName":"countdistinct(statement_id)","displayName":"Query Count"}]},"frame":{"showTitle":true,"title":"Cost By User"},"mark":{"colors":["#00A972","#FFAB00","#00A972","#FF3621","#8BCAE7","#AB4057","#99DDB4","#FCA4A1","#919191","#BF7080"]}}},"position":{"x":0,"y":13,"width":2,"height":8}},{"widget":{"name":"b034a298","queries":[{"name":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_executed_by","query":{"datasetName":"3e6fd95c","fields":[{"name":"executed_by","expression":"`executed_by`"},{"name":"executed_by_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-multi-select","encodings":{"fields":[{"fieldName":"executed_by","displayName":"executed_by","queryName":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_executed_by"}]},"frame":{"showTitle":true,"title":"User","showDescription":true,"description":"User or service principal running the statement"}}},"position":{"x":0,"y":8,"width":2,"height":2}},{"widget":{"name":"09a2a1f3","queries":[{"name":"dashboards/01efdcd2775e1c1a8a1866858634977b/datasets/01efdcd2775e1ed4903a87d29a6a6697_query_source_type","query":{"datasetName":"3e6fd95c","fields":[{"name":"query_source_type","expression":"`query_source_type`"},{"name":"query_source_type_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-multi-select","encodings":{"fields":[{"fieldName":"query_source_type","displayName":"query_source_type","queryName":"dashboards/01efdcd2775e1c1a8a1866858634977b/datasets/01efdcd2775e1ed4903a87d29a6a6697_query_source_type"}]},"frame":{"showTitle":true,"title":"Query Source Type","showDescription":true,"description":"Type of Object (i.e dashboard, SQL Query, JOB, notebook)"}}},"position":{"x":2,"y":8,"width":1,"height":2}},{"widget":{"name":"f80f81da","queries":[{"name":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_query_source_id","query":{"datasetName":"3e6fd95c","fields":[{"name":"query_source_id","expression":"`query_source_id`"},{"name":"query_source_id_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-multi-select","encodings":{"fields":[{"fieldName":"query_source_id","displayName":"query_source_id","queryName":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_query_source_id"}]},"frame":{"showTitle":true,"title":"Query Source Id","showDescription":true,"description":"Id of object such as a dashboard, SQL query, job, etc."}}},"position":{"x":3,"y":8,"width":2,"height":2}},{"widget":{"name":"8925bd62","textbox_spec":"## Charts\n----"},"position":{"x":0,"y":10,"width":6,"height":1}},{"widget":{"name":"af6d1285","textbox_spec":"## Statement Level Detail\n----"},"position":{"x":0,"y":29,"width":6,"height":1}},{"widget":{"name":"f1e3bb79","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"statement_id","expression":"`statement_id`"},{"name":"statement_text","expression":"`statement_text`"},{"name":"allocated_dollars_usage_bar_html","expression":"`allocated_dollars_usage_bar_html`"},{"name":"executed_by","expression":"`executed_by`"},{"name":"warehouse_name","expression":"`warehouse_name`"},{"name":"duration_seconds","expression":"`duration_seconds`"},{"name":"query_work_duration_seconds","expression":"`query_work_duration_seconds`"},{"name":"start_time","expression":"`start_time`"},{"name":"end_time","expression":"`end_time`"},{"name":"query_work_start_time","expression":"`query_work_start_time`"},{"name":"query_work_end_time","expression":"`query_work_end_time`"},{"name":"query_source_type","expression":"`query_source_type`"},{"name":"query_source_id","expression":"`query_source_id`"},{"name":"client_application","expression":"`client_application`"},{"name":"workspace_id","expression":"`workspace_id`"},{"name":"query_attributed_dollars_with_discount","expression":"`query_attributed_dollars_with_discount`"},{"name":"query_attributed_dbus_estimation","expression":"`query_attributed_dbus_estimation`"},{"name":"query_attributed_dollars_estimation","expression":"`query_attributed_dollars_estimation`"},{"name":"statement_hour_bucket_costs","expression":"`statement_hour_bucket_costs`"},{"name":"query_profile_url","expression":"`query_profile_url`"},{"name":"url_helper","expression":"`url_helper`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"statement_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ query_profile_url }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"link","visible":true,"order":0,"title":"Statement Id (link to query profile)","allowSearch":true,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"cellFormat":{"default":{"foregroundColor":"#077A9D"},"rules":[]},"displayName":"statement_id"},{"fieldName":"statement_text","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":1,"title":"Query Text","allowSearch":false,"alignContent":"left","allowHTML":true,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"defaultColumnWidth":300,"description":"Raw text of the statement query that was executed","displayName":"statement_text"},{"fieldName":"allocated_dollars_usage_bar_html","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":2,"title":"Attributed Usage ($)","allowSearch":false,"alignContent":"left","allowHTML":true,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"defaultColumnWidth":200,"description":"Allocated dollars for attributed query (this is an estimate based on query work)","displayName":"allocated_dollars_usage_bar_html"},{"fieldName":"executed_by","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":4,"title":"Executed by","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"executed_by"},{"fieldName":"warehouse_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":6,"title":"Warehouse","allowSearch":true,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Current name of the warehouse it was run on (warehouse ids are permanent but names are not)","displayName":"warehouse_name"},{"fieldName":"duration_seconds","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":7,"title":"Query Duration (s)","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Runtime of the query in seconds","cellFormat":{"default":{"foregroundColor":"#077A9D"},"rules":[]},"displayName":"duration_seconds"},{"fieldName":"query_work_duration_seconds","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":8,"title":"Work Duration (s)","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Amount of seconds query spent doing work (execution + result fetch)","displayName":"query_work_duration_seconds"},{"fieldName":"start_time","dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"datetime","displayAs":"datetime","visible":true,"order":10,"title":"Start Time","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"start_time"},{"fieldName":"end_time","dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"datetime","displayAs":"datetime","visible":true,"order":11,"title":"End Time","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"end_time"},{"fieldName":"query_work_start_time","dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"datetime","displayAs":"datetime","visible":true,"order":12,"title":"Work Start Time","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Start time query began doing work (executing) - can be greater than start_time if it waits in the queue","displayName":"query_work_start_time"},{"fieldName":"query_work_end_time","dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"datetime","displayAs":"datetime","visible":true,"order":13,"title":"Work End Time","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Time when query finishes work. This can be greater than end_time because it includes time spent returning results. ","displayName":"query_work_end_time"},{"fieldName":"query_source_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":14,"title":"Query Source Type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Databricks internal asset source type (i.e. dashboard, notebook, job, etc.)","displayName":"query_source_type"},{"fieldName":"query_source_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ url_helper }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"link","visible":true,"order":15,"title":"Query Source Id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Id of the asset type (i.e. if source type = 'JOB' then this will be the job id that ran the query)","displayName":"query_source_id"},{"fieldName":"client_application","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":16,"title":"Client App","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"External registered client name (like DBSQL Dashboards, Power BI, Fivetran, etc.)","displayName":"client_application"},{"fieldName":"workspace_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":17,"title":"Workspace Id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"workspace_id"},{"fieldName":"query_attributed_dollars_with_discount","numberFormat":"$ 0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":18,"title":"Attributed Usage ($) - Discount","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Estimated query attributed costs with discount param included","cellFormat":{"default":{"foregroundColor":"#00A972"},"rules":[]},"displayName":"query_attributed_dollars_with_discount"},{"fieldName":"query_attributed_dbus_estimation","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":19,"title":"Attributed Usage (DBUs)","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Estimated query attributed dbu usage","cellFormat":{"default":{"foregroundColor":"#077A9D"},"rules":[]},"displayName":"query_attributed_dbus_estimation"},{"fieldName":"query_attributed_dollars_estimation","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":20,"title":"Attributed Usage ($) - List","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"Estimated query attributed cost at list rate","displayName":"query_attributed_dollars_estimation"},{"fieldName":"statement_hour_bucket_costs","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"complex","displayAs":"json","visible":true,"order":31,"title":"Query Cost Hourly Breakdown","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"If queries span multiple hours, the costs are allocated on an hourly basis, so a total query costs can span multiple hours. This shows what % of the cost is allocated to which hour for that warehouse","displayName":"statement_hour_bucket_costs"}]},"invisibleColumns":[{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"allocated_dbus_usage_bar_html","type":"string","displayAs":"string","order":3,"title":"Allocated DBUs","allowSearch":false,"alignContent":"left","allowHTML":true,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"defaultColumnWidth":200},{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"warehouse_id","type":"string","displayAs":"string","order":5,"title":"Warehouse Id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"query_work_task_time_seconds","type":"float","displayAs":"number","order":9,"title":"Query Task Time (s)","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"description":"The total executor task time used by the query","cellFormat":{"default":{"foregroundColor":"#077A9D"},"rules":[]}},{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"url_helper","type":"string","displayAs":"string","order":21,"title":"url_helper","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"query_profile_url","type":"string","displayAs":"string","order":22,"title":"query_profile_url","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"most_recent_billing_hour","type":"datetime","displayAs":"datetime","order":23,"title":"most_recent_billing_hour","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"billing_record_check","type":"string","displayAs":"string","order":24,"title":"billing_record_check","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"fully_loaded_max_usage","type":"float","displayAs":"number","order":25,"title":"fully_loaded_max_usage","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"fully_loaded_min_usage","type":"float","displayAs":"number","order":26,"title":"fully_loaded_min_usage","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"fully_loaded_max_usage_dbus","type":"float","displayAs":"number","order":27,"title":"fully_loaded_max_usage_dbus","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"fully_loaded_min_usage_dbus","type":"float","displayAs":"number","order":28,"title":"fully_loaded_min_usage_dbus","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"group_key","type":"string","displayAs":"string","order":29,"title":"group_key","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"time_agg_key","type":"string","displayAs":"datetime","order":30,"title":"time_agg_key","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"dateTimeFormat":"YYYY-MM-DD HH:mm:ss.SSS","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"query_start_hour","type":"datetime","displayAs":"datetime","order":32,"title":"query_start_hour","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"is_warehouse_deleted","type":"string","displayAs":"string","order":33,"title":"is_warehouse_deleted","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"cost_rank","type":"integer","displayAs":"number","order":34,"title":"cost_rank","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false}],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":true,"frame":{"showTitle":true,"title":"Query Statement Detail"}}},"position":{"x":0,"y":30,"width":6,"height":16}},{"widget":{"name":"3fd47cc4","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"countdistinct(statement_id)","expression":"COUNT(DISTINCT `statement_id`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"countdistinct(statement_id)","format":{"type":"number-plain","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Count of Unique statement_id"}},"frame":{"showTitle":true,"title":"Query Statement Count"}}},"position":{"x":0,"y":11,"width":2,"height":2}},{"widget":{"name":"37fa2ea4","queries":[{"name":"parameter_dashboards/01efde5dd4c51fc89e1caf2a86c344d7/datasets/01efde5dd4c615cd98f5bc2e8fab18b5_top_n","query":{"datasetName":"3e6fd95c","parameters":[{"name":"top_n","keyword":"top_n"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"top_n","queryName":"parameter_dashboards/01efde5dd4c51fc89e1caf2a86c344d7/datasets/01efde5dd4c615cd98f5bc2e8fab18b5_top_n"}]},"selection":{"defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"all"}]}}},"frame":{"showTitle":true,"title":"Top N Number","showDescription":true,"description":"Optional filter ('all' or #)"}}},"position":{"x":5,"y":6,"width":1,"height":2}},{"widget":{"name":"5b94dd8d","queries":[{"name":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef015641455b4942decd4151ed3_warehouse_name","query":{"datasetName":"b6c55fed","fields":[{"name":"warehouse_name","expression":"`warehouse_name`"},{"name":"warehouse_name_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}},{"name":"parameter_dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_warehouse_name","query":{"datasetName":"3e6fd95c","parameters":[{"name":"warehouse_name","keyword":"warehouse_name"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-multi-select","encodings":{"fields":[{"fieldName":"warehouse_name","displayName":"warehouse_name","queryName":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef015641455b4942decd4151ed3_warehouse_name"},{"parameterName":"warehouse_name","queryName":"parameter_dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_warehouse_name"}]},"frame":{"showTitle":true,"title":"Warehouse Name"}}},"position":{"x":3,"y":6,"width":1,"height":2}},{"widget":{"name":"e6de4fe7","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"sum(query_attributed_dollars_with_discount)","expression":"SUM(`query_attributed_dollars_with_discount`)"},{"name":"countdistinct(statement_id)","expression":"COUNT(DISTINCT `statement_id`)"},{"name":"sum(query_attributed_dbus_estimation)","expression":"SUM(`query_attributed_dbus_estimation`)"},{"name":"query_source_type","expression":"`query_source_type`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(query_attributed_dollars_with_discount)","scale":{"type":"quantitative","reverse":false},"format":{"type":"number-currency","currencyCode":"USD","abbreviation":"compact","decimalPlaces":{"type":"max","places":2}},"displayName":"Attributed Usage ($)"},"y":{"fieldName":"query_source_type","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"Source Type"},"color":{"fieldName":"sum(query_attributed_dollars_with_discount)","scale":{"type":"quantitative","colorRamp":{"mode":"scheme","scheme":"greenblue"}},"legend":{"hide":true},"displayName":"Attributed Usage ($)"},"label":{"show":true},"extra":[{"fieldName":"countdistinct(statement_id)","displayName":"Query Count"},{"fieldName":"sum(query_attributed_dbus_estimation)","format":{"type":"number-plain","abbreviation":"compact","decimalPlaces":{"type":"max","places":2}},"displayName":"Attributed Usage (DBUs)"}]},"frame":{"showTitle":true,"title":"Cost By Source Type"},"mark":{"colors":["#00A972","#FFAB00","#00A972","#FF3621","#8BCAE7","#AB4057","#99DDB4","#FCA4A1","#919191","#BF7080"]}}},"position":{"x":2,"y":13,"width":2,"height":8}},{"widget":{"name":"e43bcbfd","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"sum(query_attributed_dollars_with_discount)","expression":"SUM(`query_attributed_dollars_with_discount`)"},{"name":"sum(query_attributed_dbus_estimation)","expression":"SUM(`query_attributed_dbus_estimation`)"},{"name":"count(statement_id)","expression":"COUNT(`statement_id`)"},{"name":"query_source_id","expression":"`query_source_id`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(query_attributed_dollars_with_discount)","scale":{"type":"quantitative","reverse":false},"format":{"type":"number-currency","currencyCode":"USD","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Attributed Usage ($)"},"y":{"fieldName":"query_source_id","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"axis":{"title":"Object Id"},"displayName":"Source Object Id"},"color":{"fieldName":"sum(query_attributed_dollars_with_discount)","scale":{"type":"quantitative","colorRamp":{"mode":"scheme","scheme":"greenblue"}},"legend":{"hide":true},"displayName":"Source Object Id"},"label":{"show":true},"extra":[{"fieldName":"sum(query_attributed_dbus_estimation)","format":{"type":"number-plain","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Attributed Usage (DBUs)"},{"fieldName":"count(statement_id)","displayName":"Query Count"}]},"frame":{"showTitle":true,"title":"Cost By Source Object Id"},"mark":{"colors":["#00A972","#FFAB00","#00A972","#FF3621","#8BCAE7","#AB4057","#99DDB4","#FCA4A1","#919191","#BF7080"]}}},"position":{"x":4,"y":13,"width":2,"height":8}},{"widget":{"name":"03009168","queries":[{"name":"dashboards/01efdcd2775e1c1a8a1866858634977b/datasets/01efdcd2775e1f47ba886d022f892e0b_object_top_n_toggle","query":{"datasetName":"9dda0ef1","fields":[{"name":"object_top_n_toggle","expression":"`object_top_n_toggle`"},{"name":"object_top_n_toggle_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}},{"name":"parameter_dashboards/01efdcd2775e1c1a8a1866858634977b/datasets/01efdcd2775e1ed4903a87d29a6a6697_top_n_dimension","query":{"datasetName":"3e6fd95c","parameters":[{"name":"top_n_dimension","keyword":"top_n_dimension"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"top_n_dimension","queryName":"parameter_dashboards/01efdcd2775e1c1a8a1866858634977b/datasets/01efdcd2775e1ed4903a87d29a6a6697_top_n_dimension"},{"fieldName":"object_top_n_toggle","displayName":"object_top_n_toggle","queryName":"dashboards/01efdcd2775e1c1a8a1866858634977b/datasets/01efdcd2775e1f47ba886d022f892e0b_object_top_n_toggle"}]},"frame":{"showTitle":true,"title":"Top N Dimension","showDescription":true,"description":"i.e. (top 10 users, queries, objects)"}}},"position":{"x":4,"y":6,"width":1,"height":2}},{"widget":{"name":"8d88ad2d","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"countdistinct(executed_by)","expression":"COUNT(DISTINCT `executed_by`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"countdistinct(executed_by)","format":{"type":"number-plain","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Count of Unique executed_by"}},"frame":{"showTitle":true,"title":"User Count\n"}}},"position":{"x":2,"y":11,"width":2,"height":2}},{"widget":{"name":"f11a0fd2","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"countdistinct(query_source_id)","expression":"COUNT(DISTINCT `query_source_id`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"countdistinct(query_source_id)","format":{"type":"number-plain","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Count of Unique query_source_id"}},"frame":{"showTitle":true,"title":"Object Id Count"}}},"position":{"x":4,"y":11,"width":2,"height":2}},{"widget":{"name":"b62fe468","queries":[{"name":"main_query","query":{"datasetName":"3e6fd95c","fields":[{"name":"sum(query_attributed_dbus_estimation)","expression":"SUM(`query_attributed_dbus_estimation`)"},{"name":"count(statement_id)","expression":"COUNT(`statement_id`)"},{"name":"time_agg_key","expression":"`time_agg_key`"},{"name":"sum(query_attributed_dollars_with_discount)","expression":"SUM(`query_attributed_dollars_with_discount`)"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"time_agg_key","scale":{"type":"categorical"},"displayName":"Attributed Usage ($)"},"y":{"fieldName":"sum(query_attributed_dollars_with_discount)","scale":{"type":"quantitative"},"format":{"type":"number-currency","currencyCode":"USD","abbreviation":"none","decimalPlaces":{"type":"max","places":0}},"displayName":"Attributed Usage ($)"},"label":{"show":true},"extra":[{"fieldName":"sum(query_attributed_dbus_estimation)","format":{"type":"number-plain","abbreviation":"none","decimalPlaces":{"type":"max","places":2}},"displayName":"Attributed Usage (DBUs)"},{"fieldName":"count(statement_id)","displayName":"Query Count"}]},"frame":{"showTitle":true,"title":"Attributed Usage Cost Over Time"},"mark":{"colors":["#077A9D","#FFAB00","#00A972","#FF3621","#8BCAE7","#AB4057","#99DDB4","#FCA4A1","#919191","#BF7080"]}}},"position":{"x":0,"y":23,"width":6,"height":6}},{"widget":{"name":"e88b2e4a","queries":[{"name":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564146dbc0703226f411071_time_agg_toggle","query":{"datasetName":"773aca07","fields":[{"name":"time_agg_toggle","expression":"`time_agg_toggle`"},{"name":"time_agg_toggle_associativity","expression":"COUNT_IF(`associative_filter_predicate_group`)"}],"disaggregated":false}},{"name":"parameter_dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_date_agg_level","query":{"datasetName":"3e6fd95c","parameters":[{"name":"date_agg_level","keyword":"date_agg_level"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"date_agg_level","queryName":"parameter_dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564141b910a89950bda083e_date_agg_level"},{"fieldName":"time_agg_toggle","displayName":"time_agg_toggle","queryName":"dashboards/01efcef015641095b3b32a6af3499355/datasets/01efcef01564146dbc0703226f411071_time_agg_toggle"}]},"frame":{"showTitle":true,"title":"Time Series Unit"}}},"position":{"x":3,"y":21,"width":3,"height":2}},{"widget":{"name":"31832403","textbox_spec":"##### Time series of Attributed Usage of filtered data. Use the dropdown on the right to change time series unit. \n(Time series unit selection will only affect this chart)"},"position":{"x":0,"y":21,"width":3,"height":2}},{"widget":{"name":"8556eee0","textbox_spec":"###### Dashboard v1 2025.01.31\nReachout to jooho.yeo@databricks.com for any questions"},"position":{"x":0,"y":46,"width":2,"height":1}},{"widget":{"name":"7d70446e","textbox_spec":"# DBSQL Cost Dashboard\n-----\n\n### Sections\n- **Inputs** - (Mandatory) Choose Start Time and End Time. (Optional) - Can select specific workspaces, warehouses, users, query source types, or object ids (supported for DBX objects). \n  1. If you want to limit the results of the dashboard to top 10 users, you can specify using the \"Top N Dimension\" and \"Top N Number\" filters.\n  2. Top level counts are shown for reference as you apply different filters. \n- **Charts** - Attributed costs by 1) user 2) source type 3) object ids. If the chart is crowded, click and zoom into the chart, or use the \"Top N\" filters. Click on a bar to cross-filter across the dashboard (to select multiple filters or options, you will need to back to the inputs at the top) 4) is a time series of attributed usage ($) for the filtered down dataset. Time unit is configurable (daily, weekly, etc). \n  1. Charts can also be downloaded into a CSV file by clicking on the option on the top right corner).\n-  **Statement Level Detail** - Attributed usage ($) at the individual SQL run level. \n   1. You can click on the statement id or query source id (\"object id\") links to manage \n-----"},"position":{"x":0,"y":0,"width":6,"height":5}},{"widget":{"name":"8ab66f09","textbox_spec":"## Inputs\n----"},"position":{"x":0,"y":5,"width":6,"height":1}},{"widget":{"name":"867434c1","queries":[{"name":"parameter_dashboards/01efde5dd4c51fc89e1caf2a86c344d7/datasets/01efde5dd4c615cd98f5bc2e8fab18b5_dbsql_discount","query":{"datasetName":"3e6fd95c","parameters":[{"name":"dbsql_discount","keyword":"dbsql_discount"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"dbsql_discount","queryName":"parameter_dashboards/01efde5dd4c51fc89e1caf2a86c344d7/datasets/01efde5dd4c615cd98f5bc2e8fab18b5_dbsql_discount"}]},"frame":{"showTitle":true,"title":"DBSQL Discount (%)","showDescription":true,"description":"(i.e. 0.1 == 10% discount)"}}},"position":{"x":5,"y":8,"width":1,"height":2}}]}]}